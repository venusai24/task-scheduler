syntax = "proto3";
package sched;
option go_package = "github.com/venusai24/task-scheduler/proto";

enum GovernanceMode {
  ADVISORY_ONLY = 0;
  AUTONOMOUS = 1;
  HUMAN_GATE = 2;
}

enum TaskState {
  CREATED = 0;
  PENDING = 1;
  RUNNING = 2;
  COMPLETED = 3;
  FAILED = 4;
  ANALYZING = 5;
  NEEDS_APPROVAL = 6;
}

message Task {
  string id = 1;
  string intent_yaml = 2;
  TaskState state = 3;
  GovernanceMode mode = 4;
  int32 retry_count = 5;
  repeated string logs = 6;
  string ai_insight = 7;
  bool is_simulation = 8;
}

message SubmitRequest {
  string yaml_content = 1;
  bool dry_run = 2;
}

message SubmitResponse {
  string task_id = 1;
}

message TaskRequest {
  string task_id = 1;
}

message TaskResponse {
  Task task = 1;
}

message ApproveRequest {
  string task_id = 1;
}

message ApproveResponse {
  bool success = 1;
  string message = 2;
}

service SchedService {
  rpc SubmitIntent (SubmitRequest) returns (SubmitResponse);
  rpc GetTask (TaskRequest) returns (TaskResponse);
  rpc ApproveTask (ApproveRequest) returns (ApproveResponse);
}